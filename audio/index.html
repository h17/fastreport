<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Sound Event Detection with CNNs | Your Data Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Sound Event Detection with CNNs" />
<meta name="author" content="<a href=http://kozistr.tech/about>Hyeongchan Kim</a>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Data Science and Management" />
<meta property="og:description" content="Data Science and Management" />
<link rel="canonical" href="https://yourdatablog.com/audio/" />
<meta property="og:url" content="https://yourdatablog.com/audio/" />
<meta property="og:site_name" content="Your Data Blog" />
<meta property="og:image" content="https://yourdatablog.com/images/yomex-owo-Bm7Vm8T4BQs-unsplash.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-17T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"<a href=http://kozistr.tech/about>Hyeongchan Kim</a>"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yourdatablog.com/audio/"},"description":"Data Science and Management","@type":"BlogPosting","url":"https://yourdatablog.com/audio/","headline":"Sound Event Detection with CNNs","dateModified":"2020-10-17T00:00:00-05:00","datePublished":"2020-10-17T00:00:00-05:00","image":"https://yourdatablog.com/images/yomex-owo-Bm7Vm8T4BQs-unsplash.jpg","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://yourdatablog.com/feed.xml" title="Your Data Blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Sound Event Detection with CNNs | Your Data Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Sound Event Detection with CNNs" />
<meta name="author" content="<a href=http://kozistr.tech/about>Hyeongchan Kim</a>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Data Science and Management" />
<meta property="og:description" content="Data Science and Management" />
<link rel="canonical" href="https://yourdatablog.com/audio/" />
<meta property="og:url" content="https://yourdatablog.com/audio/" />
<meta property="og:site_name" content="Your Data Blog" />
<meta property="og:image" content="https://yourdatablog.com/images/yomex-owo-Bm7Vm8T4BQs-unsplash.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-17T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"<a href=http://kozistr.tech/about>Hyeongchan Kim</a>"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yourdatablog.com/audio/"},"description":"Data Science and Management","@type":"BlogPosting","url":"https://yourdatablog.com/audio/","headline":"Sound Event Detection with CNNs","dateModified":"2020-10-17T00:00:00-05:00","datePublished":"2020-10-17T00:00:00-05:00","image":"https://yourdatablog.com/images/yomex-owo-Bm7Vm8T4BQs-unsplash.jpg","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://yourdatablog.com/feed.xml" title="Your Data Blog" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script type="text/javascript">
require.config({
  paths: {
    jquery: 'https://code.jquery.com/jquery-3.5.0.min',
    plotly: 'https://cdn.plot.ly/plotly-latest.min'
  },

  shim: {
    plotly: {
      deps: ['jquery'],
      exports: 'plotly'
    }
  }
});
</script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Your Data Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Us</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Sound Event Detection with CNNs</h1><p class="page-description"></p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-10-17T00:00:00-05:00" itemprop="datePublished">
        Oct 17, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name"><a href=http://kozistr.tech/about>Hyeongchan Kim</a></span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#data science">data science</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/h17/fastreport/tree/master/_notebooks/2020-10-17-Sound-Event-Detection-with-CNNs.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/h17/fastreport/master?filepath=_notebooks%2F2020-10-17-Sound-Event-Detection-with-CNNs.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/h17/fastreport/blob/master/_notebooks/2020-10-17-Sound-Event-Detection-with-CNNs.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-17-Sound-Event-Detection-with-CNNs.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recent works have shown that using convolutional neural networks (CNNs) is powerful in various types of machine learning tasks like classification tasks across domains. CNN enables networks to catch informative features by fusing spatial and channel-wise information within local receptive fields at each layer. For audio signals, lots of related works take a spectrogram as input using CNN that allows extracting features both frequency and time wisely via its kernel, and these approaches show promising results.</p>
<p>Unlike sound classification tasks, sound event detection (SED) is a task to detect the events in recorded audio, and it's crucial to find the various length of single or multiple events at a segment-level. Although CNN is a powerful method to extract its feature maps, it can't capture long time dependency in audio due to the limited sizes of the receptive field. To resolve this problem, we utilize both a gated recurrent unit (GRU) and a self-attention mechanism to handle long time dependency effectively.</p>
<p>In this article, we'll explain the CNN architecture for detecting sound events by adopting the bi-GRU and self-attention module with the implementation and show performances compared with different methods.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data">Data<a class="anchor-link" href="#Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>introducing cornel birdcall dataset &amp; task or in general purpose something</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-Processing">Pre-Processing<a class="anchor-link" href="#Pre-Processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There're lots of feature extraction methods from the audio signal like <em>Spectrogram</em>, <em>MFCC</em>, and there're a few great libraries that allow us to use easily, for example, <code>librosa</code>. However, extracting these features from the signals takes a bit of time, especially for extracting features from tons of long audios. By the following, when extracting features and training a neural network, sometimes it becomes a bottleneck because of computation power.</p>
<p>To resolve the issue, we utilize a library, <code>torchlibrosa</code>, PyTorch implementation of <code>librosa</code>. One of the advantages of using the library is it can run on <strong>GPU</strong>, faster than running on <strong>CPU</strong>.</p>
<p>Here is a benchmark between running on GPU and CPU.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>To-Do : add a benchmark</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>To-Do : add an example</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="kn">from</span> <span class="nn">torchlibrosa.stft</span> <span class="kn">import</span> <span class="n">LogmelFilterBank</span><span class="p">,</span> <span class="n">Spectrogram</span>


<span class="k">class</span> <span class="nc">AudioProcessing</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spectrogram_extractor</span> <span class="o">=</span> <span class="n">Spectrogram</span><span class="p">(</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_size</span><span class="p">,</span>
            <span class="n">win_length</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">,</span>
            <span class="n">freeze_parameters</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logmel_extractor</span> <span class="o">=</span> <span class="n">LogmelFilterBank</span><span class="p">(</span>
            <span class="n">sr</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
            <span class="n">n_mels</span><span class="o">=</span><span class="n">mel_bins</span><span class="p">,</span>
            <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span>
            <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
            <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
            <span class="n">amin</span><span class="o">=</span><span class="n">amin</span><span class="p">,</span>
            <span class="n">top_db</span><span class="o">=</span><span class="n">top_db</span><span class="p">,</span>
            <span class="n">freeze_parameters</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrogram_extractor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># (batch_size, 1, time_steps, freq_bins)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logmel_extractor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>       <span class="c1"># (batch_size, 1, time_steps, mel_bins)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Architecture">Architecture<a class="anchor-link" href="#Architecture"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>introducing related works on SED task like PANNs</li>
<li>introducing our architecture</li>
</ul>
<ul>
<li>explain why we chose / adopt this architecture</li>
<li>explain why this architecture works</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-Recipe">Training Recipe<a class="anchor-link" href="#Training-Recipe"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Training Recipe is also the most crucial part of deep-learning. It also determines the performance of the architecture by optimizers, a learning rate scheduler, augmentations, etc.</p>
<ul>
<li>augmentations</li>
<li>hyper-parameters</li>
<li>etc...</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Performance-&amp;-Visualization">Performance &amp; Visualization<a class="anchor-link" href="#Performance-&amp;-Visualization"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2>
</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/audio/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Data Science and Management</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
